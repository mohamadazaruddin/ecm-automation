<!-- Code Generated by Sidekick is for learning and experimentation purposes only. -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Team Mapping</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      h2 {
        color: #15538b;
        margin-bottom: 10px;
      }
      .search-bar {
        margin-bottom: 20px;
        height: 20px;
        width: 300px;
        border-radius: 4px;
        padding: 4px 8px;
      }
      #orgTable {
        border-collapse: collapse;
        width: 100%;
        background-color: #f8f9fa;
      }
      #orgTable th,
      #orgTable td {
        border: 1px solid #b0bec5;
        padding: 8px 12px;
        text-align: left;
      }
      #orgTable th {
        background-color: #dee3ec;
        color: #0b1925;
      }
      #orgTable tr.hide {
        display: none;
      }
      .upload-section {
        margin-bottom: 24px;
      }
    </style>
  </head>
  <body>
    <h2>Team Mapping : Last updated on 10/23/2025</h2>
    <div class="upload-section">
      <label for="fileInput"
        ><strong>Select file from: z/sheduling</strong></label
      >
      <input type="file" id="fileInput" accept=".xlsx, .xls" />
    </div>
    <input
      type="text"
      id="searchInput"
      class="search-bar"
      placeholder="Search by name..."
      onkeyup="searchTable()"
    />
    <table id="orgTable">
      <thead></thead>
      <tbody></tbody>
    </table>
    <script>
      document
        .getElementById("fileInput")
        .addEventListener("change", function (e) {
          const file = e.target.files[0];
          const reader = new FileReader();
          reader.onload = function (event) {
            const data = new Uint8Array(event.target.result);
            const workbook = XLSX.read(data, { type: "array" });

       
            const firstSheetName = workbook.SheetNames[0];
            const worksheet = workbook.Sheets[firstSheetName];

            
            const json = XLSX.utils.sheet_to_json(worksheet, {
              header: 1,
              raw: false,
            });

     
            const table = document.getElementById("orgTable");
            const thead = table.querySelector("thead");
            const tbody = table.querySelector("tbody");
            thead.innerHTML = "";
            tbody.innerHTML = "";

            if (json.length > 0) {
              
              let thRow = "<tr>";
              json[0].forEach((col) => (thRow += `<th>${col}</th>`));
              thRow += "</tr>";
              thead.innerHTML = thRow;
              
              for (let i = 1; i < json.length; i++) {
                let trRow = "<tr>";
                json[i].forEach((cell) => {
               
                  trRow += `<td>${cell !== undefined ? cell : ""}</td>`;
                });
                trRow += "</tr>";
                tbody.innerHTML += trRow;
              }
            }
          };
          reader.readAsArrayBuffer(file);
        });

      function searchTable() {
        const input = document
          .getElementById("searchInput")
          .value.toLowerCase();
        const table = document.getElementById("orgTable");
        const rows = table.querySelectorAll("tbody tr");
        rows.forEach((row) => {
         
          const cells = Array.from(row.cells);
          const match = cells.some((cell) =>
            cell.textContent.toLowerCase().includes(input)
          );
          if (match || input === "") {
            row.classList.remove("hide");
          } else {
            row.classList.add("hide");
          }
        });
      }
    </script>
  </body>
</html>
